use ezAcquire
GO

DECLARE @clauseId varchar(50)

DECLARE cur CURSOR FOR
SELECT DISTINCT I_41 FROM DocumentIndex WHERE ScanType = 'CLU'

OPEN cur
FETCH NEXT FROM cur INTO @clauseId

WHILE @@FETCH_STATUS = 0
BEGIN

    UPDATE DocumentIndex SET Status = 'C' WHERE I_41 = @clauseId
    UPDATE DocumentIndex SET Status = 'A' WHERE DocumentId = 
        (SELECT TOP 1 DocumentId FROM DocumentIndex WHERE I_41 = @clauseId ORDER BY CreateDateTime DESC)

    FETCH NEXT FROM cur INTO @clauseId 
END

CLOSE cur
DEALLOCATE cur