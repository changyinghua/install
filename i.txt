IF EXISTS ( SELECT * FROM StatisticScanStationDaily WHERE ScanStationCode= MachineCode AND ScanDate=@ScanDate )
  UPDATE StatisticScanStationDaily 
SET DocumentCount= ( select count(*) from DocumentIndexExtension where ScanStationCode= MachineCode and ScanDate = @ScanDate )
WHERE ScanStationCode= MachineCode AND ScanDate=@ScanDate
ELSE
  INSERT INTO StatisticScanStationDaily (ScanStationCode, ScanDate, DocumentCount)
SELECT MachineCode, @ScanDate,  ( select count(*) from DocumentIndexExtension
where ScanStationCode= MachineCode and ScanDate = @ScanDate )
